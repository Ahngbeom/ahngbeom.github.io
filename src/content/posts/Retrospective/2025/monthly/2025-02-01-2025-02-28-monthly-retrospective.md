---
title: "2025년 2월 회고록"
date: "2025-02-28"
permalink: /Retrospective/2025-02-01-2025-02-28-monthly-retrospective.html
legacy_url: /Retrospective/2025/monthly/2025-02-01-2025-02-28-monthly-retrospective.html
---
# 2025년 2월 회고록

## 개요

2025년 2월에는 **29개의 Jira 이슈**와 **61개의 커밋**(BE 31개 + FE 4개 + helm 1개 + DB Migration 17개 + DB 스키마 8개)을 처리하며 **결제 시스템 MSA 분리 완료** 및 **결제 버그 대량 수정**에 집중했습니다. 11월부터 시작된 결제 서비스 MSA 분리 작업을 2월에 최종 완료하고, 이에 따른 버그들을 집중적으로 수정하여 안정화했습니다.

| 항목 | 수량 |
|------|------|
| 완료한 이슈 | 27개 |
| 진행 중 | 2개 |
| Backend 커밋 | 31개 |
| Frontend 커밋 | 4개 |
| mobidoc-helm(인프라) 커밋 | 1개 |
| mobidoc-migration(DB) 커밋 | 17개 |
| mobidoc-database(DB 스키마) 커밋 | 8개 |
| **총 커밋** | **61개** |

## 완료한 작업

### 1. 결제 시스템 MSA 분리 완료 (1개 이슈) 🏗️

11월부터 진행해온 **결제 서비스 MSA 분리 작업**을 2월에 최종 완료했습니다.

**이슈:**
- 이슈 #1 (작업) - [MSA] 결제 서비스 모듈 분리
  - 모놀리식 구조에서 결제 서비스를 독립된 마이크로서비스로 분리
  - 결제 관련 로직을 별도 모듈로 추출
  - 서비스 간 통신 인터페이스 구현

**영향:**
- 시스템 확장성 향상
- 결제 서비스 독립적 배포 가능
- 장애 격리 및 복원력 강화

### 2. 결제 시스템 버그 대량 수정 (11개 이슈) 🐛

MSA 분리 이후 발견된 결제 관련 버그를 집중적으로 수정했습니다.

**버그 이슈 (8개):**
- 이슈 #2 (버그) - 환자 처방전 페이지에서 새로고침 시 처방전 삭제 오류
- 이슈 #3 (버그) - 환자 결제 요청 상태일 때 처방전 표시 오류
- 이슈 #4 (버그) - 통합 결제 요청 시 50000 에러 발생
- 이슈 #5 (버그) - 통합 0원 결제 화면 갱신이 바로 안됨
- 이슈 #6 (버그) - 통합/환자 0원 첫 결제 & 재결제 시 결제 이력 조회 에러
- 이슈 #7 (버그) - 통합 환자 카드 삭제해도 두 번 시도 시 결제됨
- 이슈 #8 (버그) - 통합 결제 DB 마이그레이션 이전 결제 재결제 시 Runtime Exception
- 이슈 #9 (버그) - 환자 진료신청서 화면에서 결제카드 등록 안됨

**개선 이슈 (3개):**
- 이슈 #10 (개선) - 통합 결제 환불 버튼 사라짐
- 이슈 #11 (개선) - 통합 결제 실패 시 리스트에 "결제실패" 표시 안 뜸
- 이슈 #12 (개선) - 환자 결제실패 - 카드 재등록 후 결제 시 에러창 표시
- 이슈 #13 (개선) - 통합 재결제 시 결제 완료 환자 표시 안 뜸

**영향:**
- 결제 시스템 안정화
- 0원 결제 프로세스 정상화
- 결제 이력 조회 개선
- 카드 등록 및 재결제 로직 강화

### 3. 카카오톡 청구서 발송 기능 재구현 (2개 이슈) 💳

하이패스 결제 실패 시 카카오톡 청구서 발송 기능을 재구현했습니다.

**이슈:**
- 이슈 #14 (버그) - 통합 하이패스 결제 실패 시 카카오톡 청구서 발송 기능 재구현
- 이슈 #15 (버그) - 통합 첫 결제 실패 시에도 카카오톡 청구서 발송

**영향:**
- 결제 실패 시 환자에게 즉시 청구서 발송
- 결제 회수율 향상
- 환자 편의성 증대

### 4. 환자 환불 프로세스 개선 (1개 이슈) 💰

**이슈:**
- 이슈 #16 (개선) - 환자 진료비 환불 - 환자 앱에서 처방전 확인 불가
  - 환불 시에도 처방전 확인 가능하도록 개선
  - 환자 앱 UI 개선

**영향:**
- 환불 프로세스 투명성 향상
- 환자 만족도 증대

### 5. 진료신청서 버그 수정 (2개 이슈) 📝

**이슈:**
- 이슈 #17 (버그) - 환자 진료신청서 - 진료받을 환자가 1명만 조회되었을 경우 자동 선택 조건 오류
- 이슈 #18 (개선) - 환자 예약 건 실시간 갱신 - 변경 시

**영향:**
- 진료신청서 자동 선택 로직 정교화
- 예약 실시간 갱신 기능 개선

### 6. 가예약 시스템 마무리 (2개 이슈) 🔧

1월에 이어 가예약 시스템의 남은 버그를 수정했습니다.

**이슈:**
- 이슈 #19 (개선) - 환자 예약 접수 시 중복 문자 2번 전송됨 - 가예약
- 이슈 #20 (버그) - 통합 환자 접수하면 가예약이 그냥 접수됨

**영향:**
- 가예약 시스템 완전 안정화
- 중복 문자 발송 방지
- 접수 프로세스 정교화

### 7. DB 작업 및 시스템 개선 (6개 이슈) 🗄️

다양한 DB 작업과 시스템 개선을 수행했습니다.

**이슈:**
- 이슈 #21 (작업) - [DB] 환자 알람 외래 키 연결
- 이슈 #22 (개선) - [DB작업] hospital_patient INDEX 개편 (진행 중)
- 이슈 #23 (작업) - [DB] 배치 테이블 생성
- 이슈 #24 (작업) - [DB] 로그인 모듈 통합에 따른 데이터베이스 작업
- 이슈 #25 (작업) - [DB작업] optimecode 통일화 DB작업
- 이슈 #26 (작업) - [DB] MTM 프로젝트 - UserTracking 테이블 변경

**영향:**
- DB 구조 최적화
- 외래 키 정합성 강화
- 인덱스 개편으로 성능 향상

### 8. 기타 버그 수정 및 개선 (3개 이슈) 🔨

**이슈:**
- 이슈 #27 (개선) - 관리자 진료 결제 내역 - 병원명이 표시되지 않음
- 이슈 #28 (버그) - 통합 환자 목록 - 특정 환자 조회 시 에러 발생
- 이슈 #29 (새 기능) - [API 문서] Spring Rest Docs & Swagger UI
  - Spring Rest Docs 기반 API 문서 자동화
  - Swagger UI 통합

**영향:**
- 관리자 페이지 개선
- 환자 조회 안정화
- API 문서화 자동화

## GitLab 커밋 내역

### Backend (31개 커밋)
**레포지토리:**
- flyingdoctor-server (stag): 0개
- mobidoc-server (develop): 31개

**주요 작업:**
- 결제 서비스 MSA 분리 완료
- 결제 시스템 버그 11개 수정
- 카카오톡 청구서 발송 재구현
- DB 작업 6개 (외래 키, 인덱스, 배치 테이블 등)
- 진료신청서 버그 수정
- 가예약 시스템 마무리
- API 문서 자동화

### Frontend (4개 커밋)
**레포지토리:**
- mobidoc-front (develop): 4개
- flyingdoctor-front (develop): 0개

**작업 내용:**
1. **결제 관련 (추정 2개 커밋)**
   - 결제카드 등록 버그 수정
   - 결제 UI 개선

2. **진료신청서 개선 (추정 1개 커밋)**
   - 자동 선택 로직 수정

3. **예약 실시간 갱신 (추정 1개 커밋)**
   - 예약 변경 시 실시간 갱신 구현

### mobidoc-helm(인프라) (1개 커밋)

Helm Chart 디렉토리 구조 재정리 작업을 수행했습니다.

- 디렉토리 구조 변경에 따른 README.md 수정

### mobidoc-migration(DB 마이그레이션) (17개 커밋)
**레포지토리:**
- mobidoc-migration: 17개

**주요 작업:**
- 운영 배포 전 마이그레이션 쿼리 정리 및 수정 (02-04 x3)
- payment 리팩토링 마이그레이션 (02-05 x5)
- Clean Directory Structure (02-06 x6)
- op_time_code 디렉토리명 수정, Patient Gender, DELETE_EMPLOYEE Utils (02-06, 02-26 x2)

### mobidoc-database(DB 스키마) (8개 커밋)

| 날짜 | 커밋 메시지 |
|------|------------|
| 02-04 | DB OPTIMIZE |
| 02-04 | NOT_USED_TABLE |
| 02-04 | MOBIDOC DB VIEW 생성 |
| 02-04 | [20250204] MOBIDOC DATABASE SCHEMA UPDATE |
| 02-05 | [20250205] MOBIDOC DATABASE SCHEMA UPDATE |
| 02-06 | [20250206] MOBIDOC DATABASE SCHEMA UPDATE |
| 02-07 | [Spring Batch] Batch Metadata Table 추가 |
| 02-26 | [20250226] MOBIDOC DATABASE SCHEMA UPDATE - GENDER 컬럼 추가 |

**총 커밋: 61개 (BE 31개 + FE 4개 + helm 1개 + DB Migration 17개 + DB 스키마 8개)**

## 주요 성과 및 인사이트

### 1. 결제 시스템 MSA 분리 완료 (핵심 성과)
2024년 11월부터 시작된 **결제 서비스 MSA 분리**를 2월에 최종 완료했습니다.

**진행 과정:**
- 2024년 11월: MSA 분리 착수
- 2024년 12월: 분리 작업 진행
- 2025년 1월: 마이그레이션 및 테스트
- 2025년 2월: 최종 완료 및 안정화

**주요 작업:**
- 결제 서비스를 독립된 마이크로서비스로 분리
- 서비스 간 통신 인터페이스 구현
- DB 마이그레이션 및 데이터 정합성 확보

**영향:**
- 시스템 확장성 및 유지보수성 대폭 향상
- 결제 서비스 독립적 배포 가능
- 장애 격리로 전체 시스템 안정성 강화

### 2. 결제 버그 대량 수정 (11개)
MSA 분리 과정에서 발생한 결제 관련 버그를 집중적으로 수정했습니다:

**주요 버그 카테고리:**
- **0원 결제 이슈 (2개)**: 첫 결제, 재결제, 화면 갱신
- **결제카드 이슈 (2개)**: 카드 삭제 후 결제, 카드 등록 불가
- **결제 이력 이슈 (2개)**: 이력 조회 에러, DB 마이그레이션 이전 결제 에러
- **UI 이슈 (3개)**: 환불 버튼, 결제실패 표시, 재결제 표시
- **기타 이슈 (2개)**: 처방전 표시, 50000 에러

**해결 효과:**
- MSA 분리 후 결제 시스템 완전 안정화
- 0원 결제 프로세스 정상화
- 결제 실패 시 처리 프로세스 강화

### 3. 카카오톡 청구서 자동 발송 재구현
결제 실패 시 카카오톡 청구서 자동 발송 기능을 재구현했습니다:
- 하이패스 결제 실패 시 자동 발송
- 첫 결제 실패 시에도 자동 발송
- 결제 회수율 향상 기대

### 4. API 문서 자동화 시스템 구축
Spring Rest Docs와 Swagger UI를 통합하여 API 문서 자동화를 구현했습니다:
- 테스트 코드 기반 문서 자동 생성
- Swagger UI를 통한 API 테스트 가능
- 문서와 코드의 동기화 보장

### 5. 백엔드 중심 개발 지속
커밋 비율이 BE 88.6%, FE 11.4%로 백엔드 중심 개발이 지속되었습니다:
- MSA 분리 및 결제 버그 수정이 주로 백엔드 작업
- DB 작업 6개로 인프라 개선 지속

### 6. 완료율 유지
29개 이슈 중 27개 완료 (93.1%)로 높은 완료율을 유지했습니다.

## 다음 달 계획

### 주요 작업 계획
1. **MSA 분리 확장**: 다른 도메인의 MSA 분리 검토
2. **결제 시스템 모니터링**: MSA 분리 후 성능 및 안정성 모니터링
3. **DB 인덱스 개편 완료**: hospital_patient INDEX 개편 완료 (이슈 #22)
4. **API 문서화 확대**: Spring Rest Docs 적용 범위 확대
5. **테스트 커버리지 강화**: 결제 시스템 E2E 테스트 추가

### 기술 부채 해결
- 결제 시스템 리팩토링 (MSA 분리 후 코드 정리)
- 레거시 코드 정리
- 테스트 코드 강화

## 통계

### 이슈 유형별 분포
| 유형 | 수량 | 비율 |
|------|------|------|
| 버그 | 11개 | 37.9% |
| 개선 | 8개 | 27.6% |
| 작업 | 9개 | 31.0% |
| 새 기능 | 1개 | 3.4% |

### 완료율
- **완료**: 27개 (93.1%)
- **진행 중**: 2개 (6.9%)

### 커밋 통계
| 항목 | 수량 | 비율 |
|------|------|------|
| Backend 커밋 | 31개 | 50.8% |
| Frontend 커밋 | 4개 | 6.6% |
| mobidoc-helm(인프라) 커밋 | 1개 | 1.6% |
| mobidoc-migration(DB) 커밋 | 17개 | 27.9% |
| mobidoc-database(DB 스키마) 커밋 | 8개 | 13.1% |
| **총 커밋** | **61개** | **100%** |

**레포지토리별 상세:**
- flyingdoctor-server (stag): 0개
- mobidoc-server (develop): 31개
- flyingdoctor-front (develop): 0개
- mobidoc-front (develop): 4개

### 작업 분포
| 카테고리 | 이슈 수 |
|---------|--------|
| 결제 시스템 버그 | 11개 |
| DB 작업 및 시스템 개선 | 6개 |
| 카카오톡 청구서 발송 | 2개 |
| 진료신청서 | 2개 |
| 가예약 시스템 | 2개 |
| MSA 분리 | 1개 |
| API 문서화 | 1개 |
| 기타 | 4개 |

## 회고

### 잘한 점 👍
1. **MSA 분리 완료**:
   - 3개월에 걸친 결제 서비스 MSA 분리 최종 완료
   - 시스템 아키텍처 현대화 달성

2. **결제 버그 대량 수정**:
   - MSA 분리 후 발견된 11개 버그를 빠르게 수정
   - 결제 시스템 안정화 달성

3. **카카오톡 청구서 자동화**:
   - 결제 실패 시 즉시 청구서 발송
   - 결제 회수율 향상 기대

4. **API 문서 자동화**:
   - Spring Rest Docs + Swagger UI 통합
   - 문서와 코드의 동기화 보장

5. **높은 완료율 유지**:
   - 29개 이슈 중 27개 완료 (93.1%)

### 개선이 필요한 점 🔧
1. **결제 버그 비율 높음**:
   - MSA 분리 과정에서 많은 버그 발생
   - 마이그레이션 테스트 강화 필요

2. **프론트엔드 작업 적음**:
   - FE 커밋 11.4%로 매우 낮음
   - BE 중심 개발 지속

3. **테스트 커버리지 부족**:
   - 결제 시스템 E2E 테스트 미구축
   - MSA 분리 후 통합 테스트 필요

4. **DB 작업 진행 중**:
   - hospital_patient INDEX 개편 미완료
   - 성능 개선 지연

### 배운 점 📚
1. **MSA 분리의 복잡성**: MSA 분리는 단순히 코드를 분리하는 것이 아니라, 데이터 마이그레이션, 서비스 간 통신, 트랜잭션 관리 등 많은 고려사항이 있습니다. 3개월에 걸친 작업이 필요했고, 이후 버그 수정도 많이 필요했습니다.

2. **마이그레이션 후 버그 대량 발생**: 큰 규모의 아키텍처 변경 후에는 필연적으로 많은 버그가 발생합니다. 11개의 결제 관련 버그가 발견되었고, 빠른 수정이 중요했습니다.

3. **0원 결제의 특수성**: 0원 결제는 일반 결제와 다른 프로세스를 가지며, MSA 분리 시 특별히 주의가 필요합니다. 2개의 0원 결제 관련 버그가 발견되었습니다.

4. **API 문서 자동화의 중요성**: Spring Rest Docs를 통한 API 문서 자동화는 문서와 코드의 동기화를 보장하고, 유지보수 비용을 크게 줄입니다.

5. **카카오톡 청구서의 효과**: 결제 실패 시 즉시 카카오톡 청구서를 발송하면 결제 회수율을 크게 향상시킬 수 있습니다.

---

**작성일**: 2025년 2월 2일
