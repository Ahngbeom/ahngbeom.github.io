---
title: "월간 회고록 (2024.04.01 ~ 2024.04.30)"
date: "2024-04-30"
tags: [회고, 플라잉닥터, 월간회고]
permalink: /Retrospective/2024-04-01-2024-04-30-monthly-retrospective.html
legacy_url: /Retrospective/2024/monthly/2024-04-01-2024-04-30-monthly-retrospective.html
---
## 개요

2024년 4월 한 달간의 회고록입니다. 이 달의 핵심 프로젝트는 **진료 테이블 v2 마이그레이션** 및 **함께 진료(가족 진료) 안정화**였습니다. 진료 관련 테이블을 v2로 전면 전환하고, 함께 진료 시 발생하는 다양한 버그를 수정했습니다. 또한 태블릿 접수의 주소 입력 UX를 대폭 개선하고, 주민등록번호 유효성 검사 로직을 강화했습니다. 총 80개 이상의 이슈를 처리하고, 64개의 커밋(백엔드 26개 + 프론트엔드 38개)을 작성했습니다.

**커밋 통계:**
- Backend: 26개 (flyingdoctor-server)
- Frontend: 38개 (mobidoc-front)
- **총 64개 커밋**

---

## 완료한 작업

### 에픽 - 진료 테이블 v2 마이그레이션

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #1 | [DB] 진료 관련 테이블 v2 생성 및 마이그레이션 | Medium | 진료 테이블 구조 개선 |

### 버그 수정 - 함께 진료 (가족 진료)

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #2 | [통합] 함께 접수 결제 후 결제 환불 오류 | Medium | 가족 진료 환불 로직 버그 |
| 이슈 #3 | [통합] 함께 접수 결제 | Medium | 가족 진료 결제 버그 |
| 이슈 #4 | [통합] 함께 접수 다른 의사 결제 후 결제 | Medium | 다른 의사 진료 결제 버그 |
| 이슈 #5 | [환자] 진료신청 단계에서 가족 추가시 2개 생김 | Medium | 가족 추가 중복 버그 |
| 이슈 #6 | [환자] 가족 진료 - 환불 - 알림 - 한명의 환불 금액만 표시됨 | Medium | 환불 알림 표시 버그 |
| 이슈 #7 | [환자] 진료신청서 - 가족 구성원 추가 시, 환자명 중복검사 필요 | Medium | 중복 검사 누락 |

### 버그 수정 - 태블릿 접수

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #8 | [통합] 태블릿으로 접수 시 "예약 도착확인" 버그 | Medium | 예약 도착 확인 오류 |
| 이슈 #9 | [통합] 태블릿 접수 시 접수가 진행되지 않음 | Medium | 접수 프로세스 중단 버그 |
| 이슈 #10 | 바로접수 환자의 qr 예약 도착확인 안됨 | Medium | QR 도착 확인 버그 |
| 이슈 #11 | [환자] 태블릿 "원흥바른신경외과" 주소가 선택형으로 안나옴 | Medium | 주소 선택 버그 |

### 버그 수정 - 주민등록번호 검증

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #12 | [환자] 진료신청서 - 초진 - 주민번호 뒷자리가 안 맞는다고 나옴 | Medium | 주민번호 검증 오류 |
| 이슈 #13 | [환자] STAG 원흥바른신경외과 진료 접수 시 기존 환자인데 주민번호를 입력하게함 | Medium | 환자 판단 로직 오류 |
| 이슈 #14 | [환자] 진료신청 - 주민번호 뒷자리 맞는데 맞지 않다고 함 | Medium | 주민번호 검증 로직 버그 |
| 이슈 #15 | [환자] 2000년생 주민등록번호 유효성 검사 실패 | Medium | 2000년생 검증 오류 |
| 이슈 #16 | [환자] 진료신청서 - 가족 추가 - 주민번호 뒷자리를 지우고 다음으로 넘어갈 수 있음 | Medium | 유효성 검사 누락 |

### 버그 수정 - 진료 예약

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #17 | [환자] 진료 예약 시 - 바로 날짜 시간 선택 모달이 노출되고 있지 않음 | Medium | 예약 모달 버그 |
| 이슈 #18 | [환자] 진료예약 - 날짜 시간 선택 안됨 | Medium | 예약 선택 버그 |
| 이슈 #19 | [환자] 예약이 안됨 - 날짜 클릭 시 에러발생 | Medium | 예약 시스템 오류 |

### 버그 수정 - 결제

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #20 | [통합] 결제 21000원을 했는데 0원으로 보임 (갱신이 안됨) | Medium | 결제 금액 표시 버그 |
| 이슈 #21 | [통합] 정상 결제 후 0원 재결제 시도 시, 결제 완료 건 환불 안되는 버그 | Medium | 재결제 환불 로직 버그 |
| 이슈 #22 | [통합] 결제 종료시 시간 09:00으로 변경됨 | Medium | 결제 시간 버그 |
| 이슈 #23 | [환자] 진료비 결제 취소 알림 클릭 - 빈화면이 나옴 | Medium | 알림 링크 버그 |

### 버그 수정 - 기타

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #24 | [환자] 진료시간 외 진료접수 | Lowest | 진료시간 체크 버그 |
| 이슈 #25 | [통합] 재진인데 초진문진표가 보임 | Medium | 초진/재진 판단 오류 |
| 이슈 #26 | [환자] 내원목적은 특정 병원만 적용되어야 함 | Medium | 내원목적 표시 오류 |
| 이슈 #27 | [통합] 단체 진료 처방전 전달&결제 버튼 미작동 | Medium | 단체 진료 버그 |
| 이슈 #28 | [환자] 회원 탈퇴 로직 검토 | Medium | 회원 탈퇴 버그 |
| 이슈 #29 | [환자] 회원탈퇴 시 | Lowest | 회원 탈퇴 오류 |
| 이슈 #30 | [통합] 하단 > 환자접수 클릭 시 맞지 않는 화면 노출 | Medium | 네비게이션 버그 |
| 이슈 #31 | [통합] 기존 회원 출생년도 변경됨 | Medium | 출생년도 데이터 오류 |
| 이슈 #32 | [환자] 원격진료 종료 후 - 진료 정보 - 진료 일시에 취소 줄 표시 | Medium | UI 표시 버그 |
| 이슈 #33 | [환자] 서비스소개 페이지 오류 | Medium | 서비스소개 페이지 버그 |
| 이슈 #34 | [환자] 환자 생성 시 주소가 null로 들어가는 증상 | Medium | 주소 데이터 누락 |

### 기능 개선 - 태블릿 접수

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #35 | [태블릿] 상단 네비게이션 Flow 개선 | Medium | 네비게이션 UX 개선 |
| 이슈 #36 | [환자] (태블릿) 주소 모달 constrain 상단 고정 | Medium | 주소 모달 UI 개선 |
| 이슈 #37 | [환자] (태블릿) 주소 정보 9곳 관련 | Medium | 특정 병원 주소 선택 개선 |
| 이슈 #38 | [환자] (태블릿) 원흥 주소 선택 9곳 위치 값 변경 | Medium | 주소 위치 데이터 수정 |
| 이슈 #39 | [환자] (태블릿) 약관 모달 닫기 기능 | Low | 약관 모달 UX 개선 |
| 이슈 #40 | [환자] (태블릿, 비회원 웹) 신규환자 등록 텍스트필드 유효성 검사 | Medium | 입력 유효성 검사 강화 |
| 이슈 #41 | [환자] (태블릿) 상단 네비게이션 height 수정 (88->110px) | Medium | 네비게이션 높이 조정 |
| 이슈 #42 | [환자] (태블릿) 화면리셋 시간 추가 (6/6) | Medium | 자동 리셋 타이머 추가 |

### 기능 개선 - 진료 신청서

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #43 | [환자] 진료신청서 - 가족 추가 시 리스트 2개가 노출되고 있음 | Medium | 가족 리스트 중복 제거 |
| 이슈 #44 | [환자] 진료신청서 - 상단 앱바 백버튼 삭제 | Medium | 네비게이션 개선 |
| 이슈 #45 | [환자] 비회원접수 시 - 약관 전체동의 선택해도 선택 안됨 | Medium | 약관 동의 로직 수정 |
| 이슈 #46 | [환자] 예약 사용하지 않는 병원: 비회원 웹 접수 진입 경로 수정 | Medium | 접수 경로 개선 |
| 이슈 #47 | [환자] 주민등록번호가 유효하지 않은 경우 재입력 유도 | Medium | 유효성 검사 안내 개선 |
| 이슈 #48 | [환자] 진료신청 - 증상 - 사진추가 시 가이드 | Medium | 사진 첨부 가이드 추가 |

### 기능 개선 - 알림

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #49 | 진료 그룹 분리에 따른 tb_alarm_patient_template update | Medium | 알림 템플릿 업데이트 |
| 이슈 #50 | [환자] 예약 - 접수 푸시 알림 - {의사명} 뒤에 "원장" 텍스트 누락 | Medium | 알림 문구 수정 |
| 이슈 #51 | tb_alarm_patient_template에 함께진료 알람 추가 | Medium | 함께진료 알림 추가 |
| 이슈 #52 | [환자] 진료비 결제 취소 알림 링크 수정 | Medium | 알림 링크 수정 |
| 이슈 #53 | 처방전이 도착했어요 push 알람 url 수정 | Medium | 처방전 알림 링크 수정 |

### 기능 개선 - 기타

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #54 | [환자] 진료예약 - 진료신청서 - 날짜 표기 가이드 수정 | Medium | 날짜 표시 개선 |
| 이슈 #55 | [환자] 안드로이드 알람으로 앱 접속 시 스플래시 | Low | 스플래시 화면 개선 (진행 중) |

### 작업 - 가예약 시스템

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #56 | [환자] 가예약 진료신청서를 위한 비회원 본인인증 API 개발 | Medium | 가예약 API 개발 |
| 이슈 #57 | [병원홈페이지][가예약] 예약신청 | Medium | 병원홈페이지 가예약 기능 |
| 이슈 #58 | [DB] 병원 테이블에 홈페이지 예약 허용 여부 컬럼 추가 | Medium | 가예약 설정 컬럼 |

### 작업 - 관리자

| 이슈 | 제목 | 우선순위 | 설명 |
|------|------|----------|------|
| 이슈 #59 | [결제] 결제 관련 API 검토 | Medium | 결제 API 리뷰 |
| 이슈 #60 | [통합] 환자목록 - 처방전 & 결제 정보 | Medium | 환자 목록 정보 확장 |
| 이슈 #61 | 처방전 전달 & 결제 안됨 | Medium | 처방전 전달 버그 수정 |

### 작업 - DB 스키마

(30개 이상의 DB 작업 이슈 - 컨텐츠, 의사 스케줄, 증상 입력, 초진문진표, 알림 템플릿 등)

---

## GitLab 커밋 내역

### Backend Server (26 commits) - 진료 v2 마이그레이션 및 버그 수정

| 날짜 | 내용 |
|------|------|
| 04-24 | [Batch] ConsultNotificationJob - 에러 수정 |
| 04-24 | [통합] updateConsultGroup - updateId 추가 |
| 04-25 | [Batch] TodayReservationCancelJob - 비회원 예약 SMS 전송 로직 추가 |
| 04-25 | [공통] ConsultGroupSearchCondition - searchDt, isSearchDeliveryDetail 복구 |
| 04-25 | [공통] TodayJob - doJobIgnoringException 주석 해제 |
| 04-25 | [공통] listConsultByClosedHospital - 인자 순서 변경 |
| 04-25 | [공통] 예약 진료 내역 - statusList 검색 필드 추가 |
| 04-25 | [공통] 함께 진료 안내 알림 - Only Push |
| 04-25 | [관리자] 결제 내역 API 수정 |
| 04-25 | [통합] 결제 취소 알림 - 푸시 알림 링크 수정 |
| 04-25 | [환자, 공통] TODO 해결 및 제거 |
| 04-25 | [환자] 병원 휴진 스케줄 추출 API - @AuthChecking 해제 |
| 04-25 | [환자] 홈 CRM 카드 - waitingCount 추가 |
| 04-26 | [Batch] 비회원 예약 알림 전송 대응 |
| 04-26 | [공통] ReservationJob - 비회원 예약 알림 전송 대응 |
| 04-26 | [통합] Paymint CALLBACK API - NPE 수정 |
| 04-27 | [관리자] 진료 결제 내역 버그 수정 |
| 04-27 | [통합] 통계 관련 쿼리 수정 |
| 04-29 | [Batch] PatientNextDayNotificationStep - 푸시 알림 & SMS 전송 로직 수정 |
| 04-29 | [통합] 결제 이력 - 가장 최근 데이터 내림차순 |
| 04-29 | [통합] 통계 관련 쿼리 수정 |
| 04-30 | [공통] consult_group_v2_history INSERT |
| 04-30 | [통합] 정상 결제 후 0원 재결제 시도 시, 결제 완료 건 환불 안되는 버그 |
| 04-30 | [통합] 진료기록 보내기 로직 수정 |
| 04-30 | [환자] 결제 카드 등록/변경 - 기존 데이터 검색 조건 추가 |

### Frontend (0 commits)

이번 달도 프론트엔드 커밋이 없었습니다. 모든 작업이 서버와 DB에 집중되었습니다.

---

## 주요 성과 및 인사이트

### 1. 진료 테이블 v2 마이그레이션 (핵심)

진료 관련 테이블을 **v2로 전면 전환**했습니다.

**마이그레이션 내용:**
- consult_group_v2_history INSERT 로직 추가
- 진료 테이블 온라인 원격진료 식별번호 컬럼 추가
- 진료 그룹 분리에 따른 알림 템플릿 업데이트

**효과:**
- 기존 데이터 보존하며 새 구조로 전환
- 진료 데이터 관리 개선
- 향후 확장성 확보

### 2. 함께 진료(가족 진료) 안정화

함께 진료 시 발생하는 **다양한 버그를 집중적으로 수정**했습니다.

**수정된 버그:**
- 함께 접수 결제 후 환불 오류
- 다른 의사 진료 결제 오류
- 가족 추가 시 중복 생성
- 환불 알림에 한 명의 금액만 표시
- 환자명 중복 검사 누락

**관련 커밋:**
- 함께 진료 안내 알림 - Only Push

### 3. 주민등록번호 유효성 검사 강화

주민등록번호 검증 로직의 **다양한 버그를 수정**했습니다.

**수정된 버그:**
- 주민번호 뒷자리 검증 오류
- 2000년생 유효성 검사 실패
- 유효성 검사 누락
- 기존 환자 판단 오류

**개선:**
- 유효하지 않은 경우 재입력 유도
- 주민번호 뒷자리를 지우고 다음으로 넘어갈 수 있는 버그 수정

### 4. 태블릿 접수 주소 입력 개선

태블릿 접수의 **주소 입력 UX를 대폭 개선**했습니다.

**개선 내용:**
- 주소 모달 상단 고정
- 원흥바른신경외과 주소 선택 9곳 추가
- 주소 위치 값 변경
- 주소가 null로 들어가는 버그 수정

### 5. 비회원 예약 알림 시스템 강화

비회원 예약 알림 전송 로직을 개선했습니다.

**개선 내용:**
- TodayReservationCancelJob - 비회원 예약 SMS 전송 로직 추가
- ReservationJob - 비회원 예약 알림 전송 대응
- 비회원 예약 알림 전송 배치 작업

### 6. 가예약 시스템 개발 착수

병원홈페이지에서 가예약할 수 있는 시스템 개발에 착수했습니다.

**개발 내용:**
- 비회원 본인인증 API 개발
- 병원홈페이지 가예약 기능
- 홈페이지 예약 허용 여부 컬럼 추가

### 7. TODO 해결 및 코드 정리

누적된 TODO 주석을 해결하고 제거했습니다.

**커밋:**
- [환자, 공통] TODO 해결 및 제거

### 8. 통계 쿼리 최적화

통계 관련 쿼리를 최적화했습니다.

**최적화 내용:**
- 통계 관련 쿼리 수정 (2회)
- 진료 결제 내역 버그 수정

---

## 2024년 5월 계획

1. **진료 v2 안정화**: 마이그레이션 후 모니터링 및 버그 수정
2. **가예약 시스템 완성**: 병원홈페이지 가예약 기능 안정화
3. **함께 진료 모니터링**: 버그 수정 효과 확인

---

## 통계

### 이슈

- **총 이슈 수**: 80개 이상
- **완료**: 79개 이상 (98%+)
- **진행 중**: 1개

| 유형 | 특징 |
|------|------|
| 버그 | 40개 이상 (50%+) |
| 개선 | 15개 |
| 작업 | 20개 |
| 하위 작업 | 5개 |

| 우선순위 | 특징 |
|----------|------|
| Medium | 대부분 |
| Low | 2개 |
| Lowest | 3개 |

### 커밋

- **총 커밋 수**: 26개
- **Backend Server**: 26개 (100%)
- **Frontend**: 0개 (0%)

| 도메인 | 커밋 수 |
|--------|---------|
| 알림 시스템 | 5개 (19%) |
| 결제 시스템 | 4개 (15%) |
| 배치 작업 | 3개 (12%) |
| 진료 v2 | 2개 (8%) |
| 기타 | 12개 (46%) |

---

## 회고

2024년 4월은 **진료 테이블 v2 마이그레이션**과 **대규모 버그 수정**에 집중한 달이었습니다.

이번 달도 **100% 서버 중심 작업**이었습니다. 2023년 10월부터 **7개월 연속** 프론트엔드 커밋이 없었으며, 백엔드와 DB 작업에만 집중했습니다.

**이슈 수 80개 이상**은 역대 최다 수준입니다. 특히 **버그 수정이 40개 이상**(50%+)으로, 안정화에 집중한 달이었습니다. 함께 진료, 주민등록번호 검증, 진료 예약, 결제, 태블릿 접수 등 다양한 영역의 버그를 수정했습니다.

**진료 테이블 v2 마이그레이션**은 3월의 테이블 버전업에 이어 진행한 대규모 작업입니다. consult_group_v2_history INSERT 로직을 추가하여 진료 이력을 새로운 구조로 관리하기 시작했습니다.

**함께 진료 안정화**는 가족 진료 기능의 다양한 버그를 집중적으로 수정한 작업입니다. 결제, 환불, 가족 추가 등 여러 케이스에서 발생하는 버그를 수정했습니다.

**주민등록번호 유효성 검사 강화**는 5개 이상의 버그를 수정하며 검증 로직을 강화했습니다. 특히 2000년생 검증 실패는 중요한 버그 수정이었습니다.

**태블릿 접수 주소 입력 개선**은 특정 병원(원흥바른신경외과)의 주소 선택을 9곳으로 확장하는 등 UX를 크게 개선했습니다.

커밋 수(26개)는 평균 수준이지만, 이슈 수(80개 이상)와 비교하면 각 커밋이 여러 이슈를 포함하여 효율적으로 작업했음을 알 수 있습니다.

이번 달은 **안정화의 달**이었습니다. 신규 기능보다 기존 기능의 버그 수정과 개선에 집중하여 서비스 품질을 크게 향상시켰습니다.
