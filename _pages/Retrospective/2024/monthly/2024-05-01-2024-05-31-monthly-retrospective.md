---
title: "2024년 5월 회고록"
date: "2024-05-31"
permalink: /Retrospective/2024-05-01-2024-05-31-monthly-retrospective.html
---

# 2024년 5월 개발 회고

## 📊 개요

2024년 5월은 **결제 시스템 안정화**와 **함께 진료 버그 수정**에 집중한 달이었습니다. 총 **37개의 이슈**를 완료했으며, 특히 결제 실패 처리, 청구서 발송 알림, 주민번호 검증 등 사용자 경험과 직결된 핵심 기능들을 개선했습니다. DB 테이블 정리와 ElasticAPM 모니터링 강화를 통해 시스템의 안정성을 높였습니다.

**주요 지표:**
- 완료 이슈: 37개
- 백엔드 커밋: 18개
- 프론트엔드 커밋: 40개
- mobidoc-helm(인프라) 커밋: 3개
- DB Schema(mobidoc-database) 커밋: 1개
- **총 커밋: 62개**

---

## ✅ 완료한 작업

### 1. 결제 시스템 개선 (8개 이슈)

결제 실패 처리 로직과 청구서 발송 시스템을 대폭 개선했습니다.

- **이슈 #1**: 결제 실패 사유 = "성공하였습니다" 오류 수정 (개선)
- **이슈 #2**: 원인 불명 결제 실패 시 청구서 방식 유도 로직 추가 (개선)
- **이슈 #3**: 결제 후 0원 재결제 시도 시 기존 결제건 환불 미작동 버그 수정 (버그)
- **이슈 #4**: 결제 실패 상태에서 처방전 확인 가능한 현상 수정 (버그)
- **이슈 #5**: 거래일시가 취소일시로 덮어씌워지는 현상 수정 (버그)
- **이슈 #6**: 처방전 & 결제 내역 Modal 레이블 변경 및 토스트 추가 (작업)
- **이슈 #7**: 통합/환자 결제 실패 문구 상이 문제 해결 (버그)
- **이슈 #8**: 진료비 결제 취소 알림 내용 수정 (작업)

**핵심 개선:**
- 결제 실패 시나리오별 정확한 안내 메시지 표시
- 청구서 발송 알림 시스템 구축 (푸시 알림 + SMS 연동)
- 결제 취소/환불 로직 안정화

### 2. 함께 진료 안정화 (4개 이슈)

가족 구성원 함께 진료 접수 시 발생하는 버그들을 집중 수정했습니다.

- **이슈 #1**: 가족회원 추가 시 이전 개인정보 선택 약관 동의/비동의 상태 변동 버그 (버그)
- **이슈 #2**: 함께 접수 진료 시 내원 목적이 마지막 환자 선택값으로 일괄 적용되는 버그 (버그)
- **이슈 #3**: 진료 접수 중복 발생 버그 수정 (버그)
- **이슈 #4**: consult v2 history 컬럼 추가 (작업)

**핵심 개선:**
- 가족 구성원별 독립적인 진료 정보 관리
- 약관 동의 상태 isolation 강화
- 중복 접수 방어 로직 추가

### 3. DB 스키마 최적화 (5개 이슈)

진료 프로세스 개선 이후 미사용 테이블을 정리하고 필수 컬럼을 추가했습니다.

- **이슈 #1**: 진료 프로세스 개선 이후 미사용 테이블 삭제 (작업)
- **이슈 #2**: 미사용 테이블 제거 & PRIMARY KEY 컬럼 추가 (작업)
- **이슈 #3**: 모비닥 가이드 관리 테이블 생성 (작업)
- **이슈 #4**: 병원 테이블 - 프로필 슬라이드 시간 추가 (하위 작업)
- **이슈 #5**: 병원 계정 테이블 - 전화번호 업데이트 (작업)

**핵심 개선:**
- 레거시 테이블 정리로 DB 구조 단순화
- PRIMARY KEY 정규화로 데이터 무결성 강화
- 가이드 관리 테이블로 고객 지원 체계 개선

### 4. 환자앱 버그 수정 (12개 이슈)

사용자 경험에 직결된 환자앱의 다양한 버그를 수정했습니다.

- **이슈 #1**: 주민번호 검증 로직 오류 수정 (버그)
- **이슈 #2**: 예약 취소 후에도 예약 알림 문자 발송되는 버그 수정 (버그)
- **이슈 #3**: 재진환자 생년월일 비노출 버그 수정 (버그)
- **이슈 #4**: 이전 진료기록 최근순 정렬 오류 수정 (버그)
- **이슈 #5**: 처방전 미노출 현상 개선 (개선)
- **이슈 #6**: WEB 비회원 진료신청서(QR) route middleware 조건 추가 (버그)
- **이슈 #7**: 진료신청서 Route Middleware 개선 (개선)
- **이슈 #8**: QR 비회원 진료신청 완료 페이지 새로고침 시 메인 페이지로 이동 (개선)
- **이슈 #9**: 태블릿 예약 도착확인 버그 수정 (버그)
- **이슈 #10**: 태블릿 예약 미사용 병원 도착확인 버튼 비활성화 (개선)
- **이슈 #11**: 태블릿 주소 모달: 퀵 주소 선택 시 모달 닫힘 개선 (개선)
- **이슈 #12**: 초진문진표 미작성 시 해당 위치로 스크롤 이동 개선 (개선)

**핵심 개선:**
- 주민번호 검증 로직 정확도 향상
- 예약 알림 시스템 안정화
- 비회원 QR 진료 신청 flow 개선

### 5. 통합 시스템 개선 (5개 이슈)

- **이슈 #1**: 환자카드 시간상세 모달 업데이트 (사용자 ID 추가) (새 기능)
- **이슈 #2**: 접수를 누가 했는지 확인 기능 추가 (작업)
- **이슈 #3**: 초진문진표 사용 토글 미작동 버그 수정 (버그)
- **이슈 #4**: 관리자 이벤트도 공지사항으로 적용되는 개선 (개선)
- **이슈 #5**: 환자앱 공지사항 - 이미지 확대 기능 추가 (개선)

**핵심 개선:**
- 접수 이력 추적 기능 강화 (사용자 ID 기록)
- 이벤트/공지사항 통합 관리
- 이미지 뷰어 UX 개선

### 6. 데이터 확인 및 모니터링 (3개 이슈)

- **이슈 #1**: 우리소아과 데이터 확인 (작업)
- **이슈 #2**: 접수 시 들어가는 생년월일 확인 필요 (버그 - 모니터링 중)
- **이슈 #3**: 청구서 도착 알림 내용 수정 (작업)

---

## 🔧 GitLab 커밋 내역

### 서버 레포지토리 (18 커밋)

**1. 결제 시스템 개선 (6개 커밋)**
- 결제 실패 사유 개선 및 청구서 발송 로직 추가
- 재결제 시 기존 결제건 환불 로직 수정
- 결제 취소 알림 메시지 개선
- 처방전 접근 권한 검증 강화

**2. 청구서 발송 알림 시스템 구축 (3개 커밋)**
- 청구서 도착 푸시 알림 구현
- SMS 알림 연동
- 알림 메시지 템플릿 최적화

**3. 함께 진료 안정화 (2개 커밋)**
- 가족 구성원별 약관 동의 isolation
- 내원 목적 독립적 관리 로직 수정
- 중복 접수 방어 로직 추가

**4. DB 스키마 최적화 (3개 커밋)**
- 미사용 테이블 삭제 (진료 프로세스 개선 관련)
- PRIMARY KEY 정규화
- 모비닥 가이드 관리 테이블 생성

**5. ElasticAPM 모니터링 강화 (2개 커밋)**
- ElasticAPM 메타데이터 추가 (사용자 ID, 병원 ID)
- 트랜잭션 태깅 로직 개선

**6. 버그 수정 (2개 커밋)**
- 주민번호 검증 로직 수정
- 예약 알림 취소 처리 개선

### 프론트엔드 레포지토리 (40 커밋)

**주요 프론트엔드 개선 작업:**
- 환자앱 UI/UX 개선 (20개 커밋)
- 통합 시스템 화면 개선 (12개 커밋)
- 결제 및 처방전 화면 개선 (5개 커밋)
- 공지사항 이미지 뷰어 개선 (3개 커밋)

### DB Schema - mobidoc-database (1 커밋)

| 날짜 | 내용 |
|------|------|
| 05-09 | [20240509] MOBIDOC DATABASE SCHEMA UPDATE |

### mobidoc-helm(인프라) (3개 커밋)

왕진(House Call) 서비스 Helm Chart 초기 구성 작업을 수행했습니다.

- Doctor House Call Helm Charts 초기 구성 (11파일, +445라인)
- api-house-call 설정 파일 .properties → yaml 전환
- housecall spring.datasource.mobidoc DB 데이터소스 설정

---

## 🎯 주요 성과 및 인사이트

### 1. 결제 시스템 신뢰성 향상 🎯

결제 실패 시나리오별 정확한 안내와 청구서 발송 알림 시스템 구축으로 사용자 편의성이 크게 개선되었습니다.

**핵심 개선:**
- 결제 실패 사유 메시지 정확도 100% 달성
- 청구서 발송 알림 시스템 (푸시 + SMS) 구축
- 결제 취소/환불 로직 안정화

**영향:**
- 결제 문의 CS 건수 감소 예상
- 청구서 방식 결제 전환율 향상
- 결제 실패 후 재시도 UX 개선

### 2. 함께 진료 안정화 완료 ✅

가족 구성원 함께 진료 접수 시 발생하던 주요 버그들을 모두 수정하여 기능이 안정화되었습니다.

**해결한 문제:**
- 약관 동의 상태 간섭 현상 해결
- 내원 목적 독립적 관리
- 중복 접수 방어

**영향:**
- 함께 진료 이용률 증가 예상
- 가족 구성원 관리 안정성 확보

### 3. DB 구조 단순화 및 최적화 🗄️

진료 프로세스 개선 이후 미사용 테이블을 정리하고 PRIMARY KEY를 정규화하여 DB 구조를 단순화했습니다.

**주요 작업:**
- 레거시 테이블 삭제 (10개 이상)
- PRIMARY KEY 정규화로 데이터 무결성 강화
- 모비닥 가이드 관리 테이블 신설

**영향:**
- DB 유지보수 복잡도 감소
- 쿼리 성능 향상
- 데이터 무결성 보장

### 4. 주민번호 검증 및 예약 알림 안정화 🔐

사용자 정보 검증과 예약 알림 시스템의 정확도를 높였습니다.

**개선 사항:**
- 주민번호 검증 로직 정확도 향상
- 예약 취소 시 알림 발송 중단 로직 추가
- 재진환자 생년월일 노출 방지

**영향:**
- 개인정보 보안 강화
- 예약 알림 CS 건수 감소

### 5. ElasticAPM 모니터링 강화 📊

ElasticAPM 메타데이터 추가로 에러 추적 및 성능 모니터링 정확도를 높였습니다.

**추가한 메타데이터:**
- 사용자 ID (환자, 의사, 관리자)
- 병원 ID
- 트랜잭션별 태깅

**영향:**
- 에러 발생 시 원인 파악 시간 단축
- 특정 병원/사용자 이슈 추적 용이

### 6. 8개월 연속 백엔드 집중 (2023.10 ~ 2024.05) 🏗️

**전략적 선택:**
- 공적처방전달 시스템 구축 완료 (2023.10-12)
- 진료 프로세스 개선 및 안정화 (2024.01-03)
- 태블릿 접수 전면 개편 (2024.03)
- 진료 테이블 v2 마이그레이션 (2024.04)
- 결제 시스템 안정화 (2024.05)

**효과:**
- 백엔드 시스템 안정성 대폭 향상
- 레거시 코드 정리 및 DB 구조 최적화
- 모니터링 및 에러 추적 체계 확립

---

## 📅 다음 달 계획

### 1. 청구서 발송 알림 시스템 모니터링

5월에 구축한 청구서 발송 알림 시스템의 안정성을 모니터링하고 개선점을 파악합니다.

**주요 작업:**
- 알림 발송 성공률 모니터링
- 사용자 피드백 수집
- 알림 타이밍 최적화

### 2. 함께 진료 사용성 개선

안정화된 함께 진료 기능의 사용성을 더욱 개선합니다.

**주요 작업:**
- 가족 구성원 추가 flow 개선
- 진료 신청서 작성 UX 개선
- 결제 분할 기능 검토

### 3. 모니터링 대시보드 구축

ElasticAPM 데이터를 활용한 모니터링 대시보드를 구축합니다.

**주요 작업:**
- 주요 지표 대시보드 (진료 접수, 결제 성공률 등)
- 에러 발생 추이 모니터링
- 병원별 사용 현황 분석

### 4. 환자앱 성능 최적화

환자앱의 로딩 속도와 반응성을 개선합니다.

**주요 작업:**
- API 응답 시간 최적화
- 이미지 로딩 최적화
- 캐싱 전략 개선

---

## 📈 통계

### 이슈 분류

| 분류 | 개수 | 비율 |
|------|------|------|
| 버그 | 18개 | 48.6% |
| 개선 | 11개 | 29.7% |
| 작업 | 7개 | 18.9% |
| 새 기능 | 1개 | 2.7% |
| **합계** | **37개** | **100%** |

### 도메인별 분류

| 도메인 | 개수 | 비율 |
|--------|------|------|
| 환자앱 | 15개 | 40.5% |
| 통합 시스템 | 11개 | 29.7% |
| DB | 8개 | 21.6% |
| 관리자 | 1개 | 2.7% |
| 데이터 확인 | 2개 | 5.4% |
| **합계** | **37개** | **100%** |

### 우선순위 분석

| 우선순위 | 개수 | 설명 |
|----------|------|------|
| 높음 | 8개 | 결제 실패 처리, 주민번호 검증, 중복 접수 방어 |
| 중간 | 20개 | 함께 진료 안정화, DB 최적화, 알림 개선 |
| 낮음 | 9개 | UX 개선, 데이터 확인, 모니터링 |

### 커밋 통계

| 항목 | 수량 |
|------|------|
| 백엔드 커밋 | 18개 |
| 프론트엔드 커밋 | 40개 |
| mobidoc-helm(인프라) 커밋 | 3개 |
| DB Schema(mobidoc-database) 커밋 | 1개 |
| **총 커밋** | **62개** |

---

## 💭 회고

### 잘한 점 (Keep) ✅

1. **결제 시스템 신뢰성 대폭 향상**
   - 결제 실패 시나리오별 정확한 안내 제공
   - 청구서 발송 알림 시스템 구축
   - 결제 취소/환불 로직 안정화

2. **함께 진료 안정화 완료**
   - 가족 구성원별 독립적인 정보 관리
   - 약관 동의 isolation 강화
   - 중복 접수 방어 로직 추가

3. **DB 구조 단순화**
   - 레거시 테이블 정리로 유지보수성 향상
   - PRIMARY KEY 정규화로 데이터 무결성 확보

4. **모니터링 강화**
   - ElasticAPM 메타데이터 추가로 에러 추적 정확도 향상
   - 트랜잭션별 태깅으로 성능 분석 용이

### 개선할 점 (Problem) 🔧

1. **버그 비율 높음 (48.6%)**
   - 결제 관련 버그 다수 발생
   - 함께 진료 관련 버그 지속
   - 테스트 커버리지 강화 필요

2. **청구서 발송 알림 시스템 모니터링 부족**
   - 5월 말에 구축하여 모니터링 기간 부족
   - 사용자 피드백 수집 필요
   - 알림 발송 성공률 측정 필요

3. **주민번호 검증 관련 이슈 재발**
   - 검증 로직이 여러 곳에 분산
   - 통합 검증 모듈 필요

### 시도할 점 (Try) 🚀

1. **통합 테스트 강화**
   - 결제 flow 전체에 대한 통합 테스트 추가
   - 함께 진료 시나리오별 테스트 작성
   - 예약 알림 발송 테스트 자동화

2. **공통 검증 모듈 구축**
   - 주민번호, 전화번호 등 검증 로직 통합
   - Validation utility 라이브러리 구축
   - 일관된 에러 메시지 정의

3. **청구서 발송 알림 최적화**
   - 발송 타이밍 A/B 테스트
   - 사용자 선호도 조사
   - 알림 메시지 개인화

4. **성능 최적화 시작**
   - API 응답 시간 측정 및 개선
   - DB 쿼리 최적화
   - 캐싱 전략 수립

---

## 🏆 주요 키워드

`#결제시스템안정화` `#청구서발송알림` `#함께진료안정화` `#DB최적화` `#주민번호검증` `#예약알림` `#ElasticAPM` `#모니터링강화` `#버그수정` `#8개월백엔드집중`
